<p style="color: green"><%= notice %></p>

<div id='search-cliente'>
  <%= form_with(url: clientes_path, method: 'get') do |form| %>
    <h3>Procurar clientes</h3>
    Filtrar por
    <%= select_tag(:atributo, options_for_select([
                                                   ['Nome', 'nome'],
                                                   ['CPF', 'cpf'],
                                                   ['Email', 'email']
                                                 ])) %>
    <%= text_field_tag(:busca) %>
    <%= form.submit("Procurar") %>
  <% end %>
  <%= link_to "Redefinir Filtragem", clientes_path %>
</div>

<div class='list'>
  <% if @clientes.present? %>
    <table>
      <thead>
      <tr>
        <th>ID</th>
        <th>Nome</th>
        <th>CPF</th>
        <th>Email</th>
        <th>Ações</th>
      </tr>
      </thead>
      <tbody>
      <% @clientes.each do |cliente| %>
        <tr>
          <td><%= cliente.id %></td>
          <td><%= cliente.nome %></td>
          <td><%= cliente.cpf %></td>
          <td><%= cliente.email %></td>
          <td>
            <%= link_to "Exibir", cliente %>
            <%= link_to "Marcar Reserva", new_reserva_path(cliente_id: cliente) %>
          </td>
        </tr>
      <% end %>
      </tbody>
    </table>
  <% else %>
    <p>Nenhum cliente encontrado.</p>
  <% end %>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const selecionarAtributo = document.getElementById('attribute');
        const campoDeBusca = document.getElementById('search-fields');

        selecionarAtributo.addEventListener('change', function () {
            const opcaoSelecionada = this.value;
            if (opcaoSelecionada === 'nome' || opcaoSelecionada === 'cpf' || opcaoSelecionada === 'email') {
                campoDeBusca.innerHTML = `<label for="search">Busca por ${opcaoSelecionada}:</label>
                                  <input type="text" name="search" id="search-field" placeholder="Digite a busca...">`;
            } else {
                campoDeBusca.innerHTML = '';
            }
        });
    });
</script>
